<!--
Ant script which "delombok"s the required Zong! projects.
Call this script each time before compiling this project.
-->
<project name="zong-src.delombok" default="zong-src.delombok">
	<property name="target" value="src-zong"/>
	<property name="lombok-path" value="../lib/lib/lombok-1.14.2.jar"/>
	<target name="zong-src.delombok">
	    <echo>Delombok Zong! sources...</echo>
	    <!-- clean target directory -->
		<delete includeEmptyDirs="true">
			<fileset dir="${target}">
			    <include name="**/*"/>
        		<exclude name="readme.txt"/>
		    </fileset>
		</delete>
		<!-- delombok -->
		<taskdef classname="lombok.delombok.ant.DelombokTask" classpath="${lombok-path}" name="delombok"/>
		<delombok verbose="true" encoding="UTF-8" to="${target}" from="../core/src">
			<format value="suppressWarnings:skip" />
		</delombok>
		<delombok verbose="true" encoding="UTF-8" to="${target}" from="../layout/src">
			<format value="suppressWarnings:skip" />
		</delombok>
		<delombok verbose="true" encoding="UTF-8" to="${target}" from="../renderer/src">
			<format value="suppressWarnings:skip" />
		</delombok>
		<!-- also remove @NonNull (necessary with lombok 1.14.2, maybe later not any more?)-->
		<replace>
			<fileset dir="${target}">
				<include name="**/*.java"/>
			</fileset>
			<replacefilter token="import lombok.NonNull;"/>
			<replacefilter token="import com.xenoage.utils.annotations.NonNull;"/>
			<replacefilter token="@NonNull"/>
		</replace>
		<echo>Done.</echo>
	</target>
</project>